---
image: php:7.4

stages:
  - test

before_script:
  - php -m
  - bash ci/docker_install.sh > /dev/null

php:
  stage: test
  cache:
    paths:
      - vendor
  script:
    - composer install
    - './vendor/bin/phpcs -v -s -p --colors --extensions=php --runtime-set ignore_warnings_on_exit 1 ./'
    - './vendor/bin/phpmd ./src/app/ ansi ./phpmd.xml --ignore-violations-on-exit'

on-pull-requests:
  script: echo 'this should run on pull requests'
  only:
    - external_pull_requests
